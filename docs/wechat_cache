#微信缓存问题的解决办法#

###一.问题的由来
微信缓存真是让人又爱又恨,单页面应用利用微信缓存可以在第一次完成后用户不主动清除缓存的情况下,
不用需要加载静态资源,可以达到很流畅的效果,但是应用的过程中遇到了三个问题:  
+ 单页面应用首次加载太慢
* 服务器更新不能实时体现在客户端
* 服务器端热发布

###二.问题分析:
>1.单页面应用首次加载太慢不是微信的问题,问题在于打包生成的js文件太大,所以解决问题要努力的目标是尽量减少JS文件,有以下解决办法  
(1)webpack打包时采用代码压缩,分离第三方库打包成common.js  
(2)代码分割:除了分离第三方库之外把自己的代码打包成bundle.js和addition.js,其中bundle.js是第一次进入页面要加载的,常用页面和JS代码等
     addition.js是不常用页面打包的文件,在页面用到时再加载到本地  
(3)在服务器端配置gzip压缩,效果很明显,拿我们网站的common.js为例,未压缩前为579.3kb,压缩后为:170.6kb压缩率达到70.54%,效果很理想
   推荐一个gzip压缩检测网站:http://tool.chinaz.com/Gzips,输入js文件地址便可查看服务器压缩效果  

2.服务器客户端同步更新问题
>由于微信缓存,服务器更新不能实时提现在客户端,缓存的目的是为了让用户有更流畅的体验,但是在程序更新时缓存却成了阻碍,  
>
尤其是在微信中缓存极其难清除的情况下(很少有用户主动清除微信缓存)
js文件后面加hash值

3.服务端发布问题:
>一键发布  
热发布  
解决发布间隙问题
  
丰富:
微信缓存机制  
贴代码